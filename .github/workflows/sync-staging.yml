name: Sync Staging from Master

on:
  pull_request_target:
    branches: [master]
    types: [closed]

jobs:
  sync-staging:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    concurrency:
      group: sync-staging
      cancel-in-progress: true
    steps:
      - name: Checkout master
        uses: actions/checkout@v4
        with:
          ref: master
          fetch-depth: 0
          token: ${{ secrets.STAGING_PAT_TOKEN }}

      - name: Force push to staging
        run: git push --force origin master:staging
